Q.2
 A) Write a C program to create variable length arrays using alloca() system call

#include"stdio.h"
#include"stdlib.h"
#include"alloca.h"
int main()
{
int **a;
int i,j,c[5],r;
int count=0;
printf("Enter number of rowes = ");
scanf("%d",&r);
a=(int**)alloca(sizeof(int)*r);
for(i=0;i<r;i++)
{
printf("\n Enter number columns of row %d = ",i);
scanf("%d",&c[i]);
}
for(i=0;i<r;i++)
{
a[i]=(int*)alloca(sizeof(int)*c[i]);
}
printf("Enter element in array=\n");
for(i=0;i<r;i++)
{
printf("\n Enetr %d row=>",i);
for(j=0;j<c[i];j++)
{
printf("Enter %d column=>",j);
scanf("%d",&a[i][j]);
}
}
printf("Element of array is =>\n");
for(i=0;i<r;i++)
{
printf("\n");
for(j=0;j<c[i];j++)
{
printf("%d\t",a[i][j]);
}
}
}

/*
Output
[fy@localhost RJ(AOS)]$ gcc allock.c
[fy@localhost RJ(AOS)]$ ./a.out
Enter number of rowes = 3
Enter number columns of row 0 = 2
Enter number columns of row 1 = 3
Enter number columns of row 2 = 4
Enter element in array=
Enetr 0 row=>Enter 0 column=>1
Enter 1 column=>10
Enetr 1 row=>Enter 0 column=>2
Enter 1 column=>20
Enter 2 column=>30
Enetr 2 row=>Enter 0 column=>4
Enter 1 column=>10
Enter 2 column=>20
Enter 3 column=>30
Element of array is =>
1 10
2 20 30
4 10 20 30*/


B) Write a C program that behaves like a shell (command interpreter). It has its own prompt say “NewShell$”. Any normal shell command is executed from your shell by starting a child process to execute the system program corresponding to the command. It should additionally interpret the following command.
i) count c <filename> - print number of characters in file
ii) count w <filename> - print number of words in file
iii) count l <filename> - print number of lines in file

#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

void make_toks(char *s, char *tok[])
{
	int i=0;
	char *p;
	p = strtok(s," ");
	while(p!=NULL)
	{
 		tok[i++]=p;
		p=strtok(NULL," ");
	}
	tok[i]=NULL;
}

void count(char *fn, char op)
{
	int fh,cc=0,wc=0,lc=0;
	char c;
	fh = open(fn,O_RDONLY);
	if(fh==-1)
	{
 		printf("File %s not found.\n",fn);
		return;
	}
	while(read(fh,&c,1)>0)
	{
		if(c==' ') 
			wc++;
		else if(c=='\n')
 		{
			 wc++;
			 lc++;
 		}
 		cc++;
	}
	close(fh);
	switch(op)
	{
		case 'c': printf("No.of characters:%d\n",cc-1);
			  break;

		case 'w': printf("No.of words:%d\n",wc);
			  break;

		case 'l': printf("No.of lines:%d\n",lc+1);
			  break;

	}
}

int main()
{
	char buff[80],*args[10];
	int pid;
	while(1)
	{
 		printf("myshell$ ");
 		fflush(stdin);
 		fgets(buff,80,stdin);
 		buff[strlen(buff)-1]='\0';
 		make_toks(buff,args);
		if(strcmp(args[0],"count")==0)
 			count(args[2],args[1][0]);
		else if(strcmp(args[0],"exit")==0)
			exit(0);
		else
 		{
 			pid = fork();
 			if(pid>0)
 				wait();
 			else
 			{
 				if(execvp(args[0],args)==-1)
 					printf("Bad command.\n");
 			}
 		}
	}
	return 0;
}